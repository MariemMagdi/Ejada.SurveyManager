@page "/surveys/create"
@using System.Linq
@using System.Collections.Generic
@using Volo.Abp.Application.Dtos
@using Ejada.SurveyManager.Surveys.Dtos
@using Ejada.SurveyManager.Surveys
@using Ejada.SurveyManager.Surveys.Enums
@using Ejada.SurveyManager.Localization
@inject NavigationManager NavigationManager
@inject ISurveyAppService SurveyService
@inject IQuestionAppService QuestionService
@inject Volo.Abp.AspNetCore.Components.Web.AbpBlazorMessageLocalizerHelper<SurveyManagerResource> LH

@inherits AbpCrudPageBase<ISurveyAppService, SurveyDto, Guid, PagedAndSortedResultRequestDto, CreateSurveyDto, UpdateSurveyDto>

<Card>
    <CardHeader>
        <Row Class="justify-content-between">
            <Column ColumnSize="ColumnSize.IsAuto">
                <h2>@L["NewSurvey"]</h2>
            </Column>
            <Column ColumnSize="ColumnSize.IsAuto">
                <Button Color="Color.Secondary" Clicked="Back">
                    @L["Back"]
                </Button>
            </Column>
        </Row>
    </CardHeader>

    <CardBody>
        <Form>
            @* Keep the same pattern used in original file to avoid EditContext issues *@
            <Validations @ref="@CreateValidationsRef" Model="@NewEntity" ValidateOnLoad="false" @key="NewEntity">
                <Validation MessageLocalizer="@LH.Localize">
                    <Field>
                        <FieldLabel>@L["Name"]</FieldLabel>
                        <TextEdit @bind-Text="@NewEntity.Name">
                            <Feedback>
                                <ValidationError />
                            </Feedback>
                        </TextEdit>
                    </Field>
                </Validation>

                <Field>
                    <FieldLabel>@L["Purpose"]</FieldLabel>
                    <TextEdit @bind-Text="NewEntity.Purpose" />
                </Field>

                <Field>
                    <FieldLabel>@L["TargetAudience"]</FieldLabel>
                    <TextEdit @bind-Text="NewEntity.TargetAudience" />
                </Field>

                <Field>
                    <FieldLabel>@L["Active"]</FieldLabel>
                    <InputCheckbox @bind-Value="NewEntity.IsActive" />
                </Field>
            </Validations>

            

            <div class="mt-3">
                <Button Color="Color.Secondary" Clicked="Back">
                    @L["Cancel"]
                </Button>

                <Button Color="Color.Primary"
                        Type="@ButtonType.Submit"
                        PreventDefaultOnSubmit="true"
                        Clicked="CreateEntityWithQuestionsAsync">
                    @L["Save"]
                </Button>
            </div>
        </Form>
    </CardBody>
</Card>

@code {
    

    private void Back()
    {
        NavigationManager.NavigateTo("/surveys");
    }
}